{
  "name": "auto-changelog",
  "version": "1.0.0",
  "description": "Sanity Function that automatically generates changelog entries for documents when meaningful changes are made",
  "keywords": [
    "sanity",
    "function",
    "changelog",
    "ai",
    "automation"
  ],
  "license": "MIT",
  "author": "Sanity",
  "main": "index.ts",
  "dependencies": {
    "@sanity/client": "^7.10.0",
    "@sanity/functions": "^1.0.3"
  },
  "blueprintResourceItem": {
    "type": "sanity.function.document",
    "name": "auto-changelog",
    "src": "functions/auto-changelog",
    "memory": 2,
    "timeout": 30,
    "event": {
      "on": [
        "update"
      ],
      "filter": "_type == 'post' && (delta::changedAny(content) || delta::changedAny(content[_type == 'code']))",
      "projection": "{_id, 'oldContent': pt::text(before().content), 'newContent': pt::text(after().content), changelog, 'oldCodeBlocks': before().content[_type == 'code'], 'newCodeBlocks': after().content[_type == 'code']}"
    }
  }
}
