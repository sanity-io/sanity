{"version":3,"file":"ViteDevServerStopped-CK5JuNLF.js","sources":["../../../../../../../../../../../private/var/folders/nf/jdthjt3n4sd01cj8pr9vkprc0000gp/T/sanity-latest/node_modules/sanity/src/core/studio/ViteDevServerStopped.tsx"],"sourcesContent":["import {Card, Container, Heading, Stack, Text} from '@sanity/ui'\nimport {type ReactNode, useCallback, useEffect, useState} from 'react'\nimport {type ViteHotContext} from 'vite/types/hot.js'\n\nconst ERROR_TITLE = 'Dev server stopped'\nconst ERROR_DESCRIPTION =\n  'The development server has stopped. You may need to restart it to continue working.'\n\nexport class ViteDevServerStoppedError extends Error {\n  ViteDevServerStoppedError: boolean\n\n  constructor() {\n    super(ERROR_TITLE)\n    this.name = 'ViteDevServerStoppedError'\n    this.ViteDevServerStoppedError = true\n  }\n}\nconst serverHot = import.meta.hot\nconst isViteServer = (hot: unknown): hot is ViteHotContext => Boolean(hot)\n\nconst useDetectViteDevServerStopped = () => {\n  const [devServerStopped, setDevServerStopped] = useState(false)\n\n  const markDevServerStopped = useCallback(() => setDevServerStopped(true), [])\n\n  useEffect(() => {\n    // no early return to optimize tree-shaking\n    if (isViteServer(serverHot)) {\n      serverHot.on('vite:ws:disconnect', markDevServerStopped)\n    }\n  }, [markDevServerStopped])\n\n  return {devServerStopped}\n}\n\nconst ThrowViteServerStopped = () => {\n  const {devServerStopped} = useDetectViteDevServerStopped()\n\n  if (devServerStopped) throw new ViteDevServerStoppedError()\n\n  return null\n}\n\nexport const DetectViteDevServerStopped = (): ReactNode =>\n  isViteServer(serverHot) ? <ThrowViteServerStopped /> : null\n\nexport const DevServerStoppedErrorScreen = (): ReactNode => (\n  <Card\n    height=\"fill\"\n    overflow=\"auto\"\n    paddingY={[4, 5, 6, 7]}\n    paddingX={4}\n    sizing=\"border\"\n    tone=\"critical\"\n  >\n    <Container width={3}>\n      <Stack space={4}>\n        <Heading>{ERROR_TITLE}</Heading>\n\n        <Card border radius={2} overflow=\"auto\" padding={4} tone=\"inherit\">\n          <Stack space={4}>\n            <Text size={2}>{ERROR_DESCRIPTION}</Text>\n          </Stack>\n        </Card>\n      </Stack>\n    </Container>\n  </Card>\n)\n"],"names":["ERROR_TITLE","ERROR_DESCRIPTION","ViteDevServerStoppedError","Error","constructor","name","isViteServer","Boolean","useDetectViteDevServerStopped","$","_c","devServerStopped","setDevServerStopped","useState","t0","Symbol","for","markDevServerStopped","t1","t2","useEffect","t3","ThrowViteServerStopped","DetectViteDevServerStopped","DevServerStoppedErrorScreen","Heading","jsx","Card","Container","jsxs","Stack","Text"],"mappings":"yFAIA,MAAMA,EAAc,qBACdC,EACJ,sFAEK,MAAMC,UAAkCC,KAAM,CAGnDC,aAAc,CACZ,MAAMJ,CAAW,EACjB,KAAKK,KAAO,4BACZ,KAAKH,0BAA4B,EACnC,CACF,CACA,MACMI,KAAwDC,GAExDC,EAAgCA,IAAA,CAAA,MAAAC,EAAAC,EAAAA,EAAA,CAAA,EACpC,CAAAC,EAAAC,CAAA,EAAgDC,EAAAA,SAAAA,EAAc,EAAC,IAAAC,EAAAL,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GAEtBF,EAAAA,IAAMF,EAAAA,EAAwB,EAACH,EAAAA,CAAAA,EAAAK,GAAAA,EAAAL,EAAA,CAAA,EAAxE,MAAAQ,EAA6BH,EAAgD,IAAAI,EAAAC,EAAAV,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GAEnEE,EAAAA,IAAA,CAGkD,EAEzDC,EAAAA,CAACF,CAAoB,EAACR,EAAAA,CAAAA,EAAAS,EAAAT,KAAAU,IAAAD,EAAAT,EAAA,CAAA,EAAAU,EAAAV,EAAA,CAAA,GALzBW,EAAAA,UAAUF,EAKPC,CAAsB,EAAC,IAAAE,EAAA,OAAAZ,EAAAA,CAAAA,IAAAE,GAEnBU,EAAA,CAAAV,iBAAAA,CAAAA,EAAkBF,KAAAE,EAAAF,EAAAA,CAAAA,EAAAY,GAAAA,EAAAZ,EAAA,CAAA,EAAlBY,CAAkB,EAGrBC,EAAyBA,IAAA,CAC7B,KAAA,CAAAX,iBAAAA,CAAAA,EAA2BH,EAAAA,EAA+B,GAEtDG,EAAgB,MAAA,IAAAT,EAAA,OAAA,IAAA,EAKTqB,EAA6BA,IAAA,CAAA,MAAAd,EAAAC,EAAAA,EAAA,CAAA,EAAA,IAAAI,EAAA,OAAAL,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GACxCF,EAAAR,EAAsB,QAAKgB,EAAA,EAAsB,EAAG,KAAOb,EAAAA,CAAAA,EAAAK,GAAAA,EAAAL,EAAA,CAAA,EAA3DK,CAA2D,EAEhDU,EAA8BA,IAAA,CAAA,MAAAf,EAAAC,EAAAA,EAAA,CAAA,EAAA,IAAAI,EAAAL,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GAI7BF,EAAA,CAAA,EAAA,EAAA,EAAA,CAAA,EAAYL,KAAAK,GAAAA,EAAAL,EAAA,CAAA,EAAA,IAAAS,EAAAT,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GAOlBE,QAACO,EAAA,CAAA,SAAAzB,CAAA,CAAqB,EAAUS,EAAAA,CAAAA,EAAAS,GAAAA,EAAAT,EAAA,CAAA,EAAA,IAAAU,EAAA,OAAAV,EAAA,CAAA,IAAAM,OAAAC,IAAA,2BAAA,GAVtCG,EAAAO,EAAAA,IAACC,EAAA,CACQ,OAAA,OACE,SAAA,OACC,SAAAb,EACA,SAAA,EACH,OAAA,SACF,KAAA,WAEL,eAACc,EAAA,CAAiB,MAAA,EAChB,SAAAC,OAACC,EAAA,CAAa,MAAA,EACZZ,SAAAA,CAAAA,EAEAQ,EAAAA,IAACC,EAAA,CAAK,OAAA,GAAe,OAAA,EAAY,SAAA,OAAgB,QAAA,EAAQ,KAAA,UACvD,SAAAD,MAACI,EAAA,CAAa,MAAA,EACZ,SAAAJ,EAAAA,IAACK,EAAA,CAAW,KAAA,EAAA,SAAA9B,CAAA,CAAsB,CAAA,CACpC,EACF,CAAA,CAAA,CACF,CAAA,CACF,EACF,EAAOQ,EAAAA,CAAAA,EAAAU,GAAAA,EAAAV,EAAA,CAAA,EAnBPU,CAmBO","x_google_ignoreList":[0]}