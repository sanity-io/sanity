name: Remove needs-more-info Label on Response

on:
  issue_comment:
    types: [created]

permissions:
  issues: write
  pull-requests: read

jobs:
  remove-label:
    runs-on: ubuntu-latest

    # Only run when:
    # - The issue has the "needs-more-info" label
    # - The commenter is the original issue author (not someone else)
    # - The commenter is a human (not a bot)
    if: >-
      contains(github.event.issue.labels.*.name, 'needs-more-info')
      && github.event.comment.user.login == github.event.issue.user.login
      && github.event.comment.user.type != 'Bot'

    env:
      GH_TOKEN: ${{ github.token }}
      ISSUE_NUMBER: ${{ github.event.issue.number }}
      REPO: ${{ github.repository }}

    steps:
      - name: Remove labels
        run: |
          gh issue edit "$ISSUE_NUMBER" --remove-label "needs-more-info" --repo "$REPO"

          # Remove stale-warned if present (user may have responded after receiving the warning)
          gh issue edit "$ISSUE_NUMBER" --remove-label "stale-warned" --repo "$REPO" 2>/dev/null || true

      - name: Post thank you comment
        run: |
          gh issue comment "$ISSUE_NUMBER" --repo "$REPO" --body \
            "Hi there, thanks for providing the additional information! We've received your update and will review it shortly. We appreciate your help in making Studio better!"
